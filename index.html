<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>NYAFTISANS - Human Creativity At Its Finest</title>

    <link href="https://fonts.googleapis.com/css2?family=Gruppo&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" type="image/jpg" href="logo.png">

    <style>
:root{
    --color-primary: #260E30;
    --color-accent: #E90075;
    --color-secondary: #634060;
    --color-light-grey: #583958;
    --max-width: 1100px;
    --white: #ffffff;
    --dark-text: #222; /* Defined for clearer use */
}

/* GLOBAL */
* { box-sizing: border-box }
html { height: 100% } /* Fix for full-height elements */
body {
    margin: 0;
    height: auto; /* Fixed for safe scrolling */
    min-height: 100vh;
    font-family: Arial, sans-serif;
    background-color: var(--color-light-grey);
    color: var(--dark-text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
}

a { color: inherit }
button { font-family: inherit; cursor: pointer; border: none; background: none; }

/* HEADER */
header{
    background: var(--color-primary);
    color: var(--white);
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    padding-bottom: 18px;
}
.header-content{
    max-width: var(--max-width);
    margin: 0 auto;
    padding: 12px 20px;
    display:flex;
    align-items:center;
    gap:12px;
    justify-content:space-between;
}
.logo-area{display:flex;align-items:center}
#logo{width:36px;height:36px;transition:transform .25s,filter .25s}
#logo:hover{transform:scale(1.05)}
.logo-text{margin-left:8px;font-family:'Gruppo',sans-serif;font-size:18px;letter-spacing:1px}

.search-bar{
    display:flex;align-items:center;background-color:var(--color-secondary);border-radius:6px;padding:6px 8px;flex:1;max-width:420px;margin:0 18px;
    transition:all .2s ease;
}
.search-bar input{
    background:transparent;border:0;outline:none;color:var(--white);width:100%;
    font-size:14px;padding:6px;
}
.search-bar button{
    background:var(--color-accent);border:0;padding:8px 10px;border-radius:4px;color:var(--white);cursor:pointer;
    display:inline-flex;align-items:center;justify-content:center;
}
.search-bar button .icon-search{width:16px;height:16px;position:relative;transform:scale(.9)}
.search-bar button .icon-search::before{content:'';position:absolute;width:10px;height:10px;border:2px solid white;border-radius:50%;top:0;left:0}
.search-bar button .icon-search::after{content:'';position:absolute;width:2px;height:6px;background:white;transform:rotate(-45deg);bottom:-1px;right:-2px}

/* USER NAV */
.user-nav{display:flex;align-items:center;gap:8px;position:relative}
.icon-link{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:6px;cursor:pointer;position:relative}
.icon-chat{width:20px;height:16px;background:white;border-radius:3px;transform:translateY(-1px)}
.icon-cart{width:20px;height:16px;border:2px solid white;border-top-left-radius:3px;border-top-right-radius:3px;position:relative}
.icon-cart::before{content:'';position:absolute;top:-4px;left:3px;width:6px;height:6px;border:2px solid white;border-top-left-radius:50%;border-top-right-radius:50%;border-bottom:none;transform:translateX(1px)}
.cart-badge{position:absolute;top:-6px;right:-6px;background:var(--color-accent);color:white;border-radius:999px;padding:2px 6px;font-size:12px;font-weight:700}

.menu-button{background:none;border:none;color:white;font-size:20px;cursor:pointer;padding:6px;border-radius:6px}

.tagline{max-width:var(--max-width);margin:8px auto 18px;padding:0 20px;text-align:center;color:white;font-size:18px;letter-spacing:2px}

/* Add this to your <style> block or external CSS file */

/* --- Base Styling and Transition Setup --- */
.nav-item-placeholder {
  /* Initial appearance */
  padding: 10px 15px;
  text-align: center;
  border-radius: 4px;
  cursor: pointer;
  background-color: #f8f9fa; /* Light gray background for non-active items */
  color: #343a40; /* Dark text for non-active items */

  /* The magic for smoothness! */
  transition: background-color 0.3s ease, color 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;
}

/* --- Hover State for NON-ACTIVE Items (Mall, Apparel, Sale) --- */
/* This rule applies to any nav-item-placeholder that DOES NOT have the 'active' class */
.nav-item-placeholder:not(.active):hover {
  background-color: white; /* **Turns white on hover** */
  color: #343a40; /* Dark text for readability on white background */
  transform: translateY(-1px);
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* UPDATED: PROFILE MENU STYLES */
.profile-menu-container{position:relative;}
.profile-icon{
    cursor:pointer;
    display:block;
    transition:box-shadow .2s;
    width:36px;
    height:36px;
    border-radius:50%; /* Made circular */
    background:var(--color-accent);
}
.profile-icon:hover{box-shadow:0 0 0 2px var(--color-secondary)}

.profile-menu{
    position:absolute;
    top:calc(100% + 10px);
    right:0;
    width:200px;
    background:var(--white);
    border-radius:8px;
    box-shadow:0 4px 12px rgba(0,0,0,0.15);
    padding:8px 0;
    z-index:1050;
    /* Animation properties */
    opacity: 0;
    transform: translateY(-5px);
    visibility: hidden;
    transition: opacity 0.2s ease, transform 0.2s ease, visibility 0s 0.2s;
}
.profile-menu.open{
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
    transition: opacity 0.2s ease, transform 0.2s ease;
}
.profile-menu a{
    display:block;padding:10px 16px;color:#333;text-decoration:none;
    transition:background-color .15s, color .15s; /* Added color transition */
    font-size:14px;
}
/* FIX: Change text color to white on hover for contrast */
.profile-menu a:hover{
    background-color:var(--color-secondary);
    color: var(--white); 
}
.profile-menu .divider{height:1px;background-color:#eee;margin:6px 0;}
.profile-menu .sign-out{color:#b00;font-weight:700;}
.profile-menu .sign-out:hover{background-color:#ffebeb; color:#b00;} /* Keep red text */

/* MAIN */
main{max-width:var(--max-width);margin:0 auto;padding:18px 20px 80px;display:block}
.top-nav-grid{display:flex;gap:12px;margin-bottom:22px}
.nav-item-placeholder{flex:1;background:var(--color-secondary);color:white;padding:8px;border-radius:6px;text-align:center;cursor:pointer;font-weight:600}
.nav-item-placeholder.active{background:var(--color-accent)}

.modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background-color: rgba(0,0,0,0.6);
  z-index: 1000;
}

.modal[aria-hidden="false"] {
  display: flex;
}

.modal-content {
  background: #fff;
  padding: 1.5rem;
  border-radius: 1rem;
  max-width: 400px;
  text-align: center;
  position: relative;
}

.close-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: none;
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
}

/* ===== Modal Base Styles ===== */
.modal {
  display: none; /* Hidden by default */
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.6);
  backdrop-filter: blur(3px);
  justify-content: center;
  align-items: center;
}

.modal-content {
  background-color: #fff;
  margin: auto;
  padding: 25px;
  border-radius: 12px;
  width: 90%;
  max-width: 400px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  animation: popIn 0.3s ease;
}

.modal-content img {
  width: 100%;
  height: auto;
  border-radius: 10px;
  margin-bottom: 15px;
}

.close-btn {
  color: #888;
  float: right;
  font-size: 24px;
  cursor: pointer;
}

.close-btn:hover {
  color: #000;
}

/* Animation */
@keyframes popIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}


/* PRODUCT GRID */
.product-grid{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:16px;
}
@media (max-width:980px){.product-grid{grid-template-columns:repeat(3,1fr)}}
@media (max-width:700px){.product-grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:420px){.product-grid{grid-template-columns:repeat(1,1fr)}}

.grid-item{
    background:white;border-radius:8px;padding:12px;box-shadow:0 4px 10px rgba(0,0,0,0.06);cursor:pointer;display:flex;flex-direction:column;gap:8px;
    transition:transform .2s ease,box-shadow .2s;
}
.grid-item:hover{transform:translateY(-6px);box-shadow:0 10px 30px rgba(0,0,0,0.12)}
.product-image{width:100%;height:160px;object-fit:cover;border-radius:6px}
.product-details h4{margin:0;font-size:15px;color:var(--color-primary)}
.product-details p.price{margin:0;font-weight:700;color:var(--color-accent);font-size:16px}

/* Product Actions - Used for View/Add to Cart */
.product-actions{display:flex;gap:8px;margin-top:auto}
.btn{padding:8px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:700; flex-grow: 1; transition: background-color .2s, transform .1s}
.btn-primary{background:var(--color-accent);color:var(--white)}
.btn-primary:hover{background:#c2185b; transform: translateY(-1px)} /* Darker accent hover */
.btn-outline{background:transparent;border:1px solid var(--color-secondary);color:var(--color-primary)}
.btn-outline:hover{background:var(--color-secondary); border-color:var(--color-secondary); color:var(--white); transform: translateY(-1px)} /* Secondary color fill hover */

/* Scrollbar Styling (Re-adding the standard styling) */
.scrollable-container::-webkit-scrollbar { height: 6px; }
.scrollable-container::-webkit-scrollbar-thumb { background-color: rgba(255,255,255,0.4); border-radius: 3px; }
.scrollable-container::-webkit-scrollbar-track { background: transparent; }

/* Scroll Card Button Styles */
.scrollable-content {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding: 10px 2px;
    /* Added to facilitate grabbing/scrolling on non-touch devices */
    cursor: grab; 
}
.scroll-card-button {
    background-color: var(--white); /* White background for the 'rectangle' */
    border: 1px solid #C8C8C8;
    border-radius: 12px;
    width: 90px;
    height: 90px;
    padding: 10px;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
    outline: none;
    transition: background-color 0.2s, transform 0.1s;
    font-size: 13px; /* Smaller font for category names */
    font-weight: 600;
    color: var(--dark-text);
}
.scroll-card-button:hover { 
    background-color: #FCFCFC; 
    transform: scale(1.02); 
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
.scroll-card-button img { 
    width: 50px; 
    height: 50px; 
    object-fit: contain; 
}

/* SCROLL AREA */
.scrollable-content{display:flex;gap:12px;overflow-x:auto;padding:10px 2px}
.scroll-card{min-width:220px;height:120px;background:var(--color-secondary);border-radius:8px;flex-shrink:0}

/* FOOTER / spacing */
footer{max-width:var(--max-width);margin:18px auto;padding:12px 20px;text-align:center;color:#666}

/* PRODUCT MODAL */
.modal{position:fixed;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:1200;padding:20px}
.modal.visible{display:flex}
.modal-content{background:white;border-radius:12px;padding:18px;max-width:720px;width:100%;max-height:90vh;overflow:auto;position:relative}
.close-btn{position:absolute;right:12px;top:8px;font-size:24px;cursor:pointer;border:none;background:none;color:#444}
.modal img{width:100%;border-radius:8px;margin-bottom:12px}
.modal h2{margin:0 0 6px}
.modal p{margin:6px 0 12px;color:#333}
.qty-controls{display:flex;align-items:center;gap:8px;margin-top:8px}
.qty-btn{border:0;background:var(--color-accent);color:white;padding:8px 10px;border-radius:6px;cursor:pointer;font-weight:700}

/* SLIDING CART SIDEBAR (LAZADA-STYLE) */
.cart-sidebar{
    position:fixed;right:-420px;top:0;height:100vh;width:420px;background:#fff;box-shadow: -20px 0 40px rgba(0,0,0,0.2);z-index:1300;
    transition:right .32s cubic-bezier(.2,.9,.2,1);display:flex;flex-direction:column;
}
.cart-sidebar.open{right:0}
.cart-header{padding:18px;border-bottom:1px solid #f0f0f0;display:flex;align-items:center;justify-content:space-between;gap:8px}
.cart-body{padding:12px;flex:1;overflow:auto}
.cart-footer{padding:14px;border-top:1px solid #f0f0f0}
.cart-item-row{display:flex;gap:12px;align-items:center;padding:10px;border-radius:8px;background:#fafafa;margin-bottom:10px}
.cart-item-row img{width:68px;height:68px;object-fit:cover;border-radius:6px}
.cart-item-info{flex:1}
.cart-item-info h4{margin:0 0 6px;font-size:15px;color:var(--color-primary)}
.cart-item-info .item-meta{display:flex;align-items:center;gap:6px;justify-content:space-between}
.qty-input{width:64px;padding:6px;border-radius:6px;border:1px solid #ddd;text-align:center}

.small{font-size:13px;color:#666}
.remove-btn{background:transparent;border:0;color:#b00;cursor:pointer;font-weight:700}

.total-row{display:flex;align-items:center;justify-content:space-between;padding:10px 0;font-weight:800;font-size:18px}

/* PAYMENT MODAL (small) */
#paymentModal .modal-content{max-width:560px}
#paymentTable{width:100%;border-collapse:collapse}
#paymentTable th,#paymentTable td{padding:8px;border-bottom:1px solid #eee;text-align:left}

/* RESPONSIVE ADJUSTMENTS */
@media (max-width:540px){
    .header-content{gap:8px;padding:10px}
    .search-bar{display:none} /* Hide search bar on very small screens */
    .cart-sidebar{width:100%;right:-100%}
    .cart-sidebar.open{right:0}
    .top-nav-grid{flex-wrap: wrap;}
}
    </style>
</head>
<body>

<header>
    <div class="header-content">
        <div class="logo-area">
            <img id="logo" src="logo.png" alt="NYAFTISANS Logo">
            <span class="logo-text">NYAFTISANS</span>
        </div>

        <div class="search-bar" role="search" aria-label="Site search">
            <input id="searchInput" type="text" placeholder="Search products..." />
            <button id="searchBtn" aria-label="Search"><div class="icon-search"></div></button>
        </div>

        <nav class="user-nav" aria-label="User navigation">
            <div class="icon-link" title="Chat">
                <i class="fa fa-comment" aria-hidden="true"></i>
            </div>

            <div id="cartButton" class="icon-link" title="Cart (click to open)">
                <div class="icon-cart" aria-hidden="true"></div>
                <div id="cartBadge" class="cart-badge" style="display:none">0</div>
            </div>

            <div class="profile-menu-container">
                <div class="profile-icon" id="profileIcon" title="Profile"></div>
                <div id="profileMenu" class="profile-menu" aria-hidden="true">
                    <a href="user-profile.html" id="editProfileLink">Edit Profile</a>
                    <a href="about us.html" id="aboutLink">About NYAFTISANS</a>
                    <div class="divider"></div>
                    <a href="#" id="signOutLink" class="sign-out">Sign Out</a>
                </div>
            </div>

            <button class="menu-button" id="menuToggle" aria-expanded="false">☰</button>
        </nav>
    </div>

    <h1 class="tagline">HUMAN CREATIVITY AT ITS FINEST</h1>
</header>

<main>
    <section class="top-nav-grid">
        <div class="nav-item-placeholder active">Home</div>
        <div class="nav-item-placeholder">Mall</div>
        <div class="nav-item-placeholder">Apparel</div>
        <div class="nav-item-placeholder">Sale</div>
    </section>

    <section class="product-grid" id="productGrid">
        <article class="grid-item" data-name="2 pcs Ribbon Beaded Keychain" data-price="150" data-img="2 pcs Ribbon Beaded Keychain.jpg">
            <img class="product-image" src="2 pcs Ribbon Beaded Keychain.jpg" alt="Ribbon Beaded Keychains">
            <div class="product-details">
                <h4>2 pcs Ribbon Beaded Keychain</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱150</span>
                    <span class="category">              | Accessory</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

       <article class="grid-item" data-name="Blue_Bracelet" data-price="75" data-img="Blue_Bracelet.png">
            <img class="product-image" src="Blue_Bracelet.png" alt="Blue Bracelet">
            <div class="product-details">
                <h4>Blue Bracelet</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱75</span>
                    <span class="category">              | Jewelry</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

       <article class="grid-item" data-name="Bookmark Keychain" data-price="120" data-img="Bookmark_Keychain.png">
            <img class="product-image" src="Bookmark_Keychain.png" alt="Bookmark Keychain">
            <div class="product-details">
                <h4>Bookmark Keychain</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱120</span>
                    <span class="category">              | Stationery</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

        <article class="grid-item" data-name="Crochet Sunflower Bag" data-price="750" data-img="Crochet Sunflower Bag.png">
            <img class="product-image" src="Crochet Sunflower Bag.png" alt="Crochet Sunflower Bag">
            <div class="product-details">
                <h4>2 pcs Ribbon Beaded Keychain</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱750</span>
                    <span class="category">              | Fashion</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

       <article class="grid-item" data-name="Crochet Stuffed Toy Bunny" data-price="300" data-img="Crochet_StuffedToy_Bunny.png">
            <img class="product-image" src="Crochet_StuffedToy_Bunny.png" alt="Crochet Stuffed Toy Bunny">
            <div class="product-details">
                <h4>Crochet Stuffed Toy Bunny</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱300</span>
                    <span class="category">              | Toy</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

       <article class="grid-item" data-name="Paper Fan (Orange or Blue)" data-price="100" data-img="DIY Paper Fan (Orange or Blue).png">
            <img class="product-image" src="DIY Paper Fan (Orange or Blue).png" alt="DIY Paper Fan (Orange or Blue)">
            <div class="product-details">
                <h4>Paper Fan (Orange or Blue)</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱100</span>
                    <span class="category">              | Craft</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

        <article class="grid-item" data-name="DIY Pen Holder" data-price="75" data-img="DIY Pen Holder.png">
            <img class="product-image" src="DIY Pen Holder.png" alt="DIY Pen Holder">
            <div class="product-details">
                <h4>DIY Pen Holder</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱75</span>
                    <span class="category">              | Craft</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

        <article class="grid-item" data-name="2 pcs Ribbon Beaded Keychain" data-price="150" data-img="DIY Yellow Wallet.png">
            <img class="product-image" src="DIY Yellow Wallet.webp" alt="DIY Yellow Wallet">
            <div class="product-details">
                <h4>DIY Yellow Wallet</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱150</span>
                    <span class="category">              | Craft</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>
    </section>

<h4 class="category-heading-white" style="font-size: 2.5rem; font-family: Georgia, serif; color: #EEE;">Categories</h4>
<section class="scrollable-container">
    <div class="scrollable-content" id="scroll-section">
        <button class="scroll-card-button">
            <img src="Jewelry_Icon.png" alt="Jewelry icon">
            <span>Fashion</span>
        </button>
        <button class="scroll-card-button">
            <img src="Bag Icon.png" alt="Bags icon">
            <span>Bags</span>
        </button>
        <button class="scroll-card-button">
            <img src="Accessories Icon.png" alt="Accessories icon">
            <span>Accessories</span>
        </button>
        <button class="scroll-card-button">
            <img src="Stationery Icon.png" alt="Stationery icon">
            <span>Stationery</span>
        </button>
        <button class="scroll-card-button">
            <img src="Toys Icon.png" alt="Toys icon">
            <span>Toys</span>
        </button>
        <button class="scroll-card-button">
            <img src="Craft Icon.png" alt="Craft icon">
            <span>Crafts</span>
        </button>
    </div>
</section>

    <section class="product-grid" id="productGrid">
        <article class="grid-item" data-name="Scrapbook_Set (Green)" data-price="120" data-img="Scrapbook_Set (Green).png">
            <img class="product-image" src="Scrapbook_Set (Green).png" alt="Scrapbook Set">
            <div class="product-details">
                <h4>Scrapbook Set (Green)</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱120</span>
                    <span class="category">              | Stationery</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

       <article class="grid-item" data-name="Bunny Stickers Set" data-price="50" data-img="Bunny Stickers Set.png">
            <img class="product-image" src="Bunny Stickers Set.png" alt="Bunny Stickers Set">
            <div class="product-details">
                <h4>Bunny Stickers Set</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱50</span>
                    <span class="category">              | Stickers</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

       <article class="grid-item" data-name="Hirono Stickers Set" data-price="75" data-img="HIrono Stickers Set.png">
            <img class="product-image" src="HIrono Stickers Set.png" alt="Hirono Stickers Set">
            <div class="product-details">
                <h4>Hirono Stickers Set</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱75</span>
                    <span class="category">              | Stickers</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

        <article class="grid-item" data-name="Kuromi Keychain" data-price="750" data-img="Kuromi_Keychain.png">
            <img class="product-image" src="Kuromi_Keychain.png" alt="Kuromi Keychain">
            <div class="product-details">
                <h4>Kuromi Keychain</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱40</span>
                    <span class="category">              | Accessory</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

       <article class="grid-item" data-name="[Customized] Starscape Keychain" data-price="100" data-img="Customized_Starscape_Keychain.png">
            <img class="product-image" src="Customized_Starscape_Keychain.png" alt="[Customized] Starscape Keychain">
            <div class="product-details">
                <h4>[Customized] Starscape Keychain</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱100</span>
                    <span class="category">              | Accessory</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

       <article class="grid-item" data-name="Seashell Crochet Bag" data-price="100" data-img="Seashell_Crochet Bag.png">
            <img class="product-image" src="Seashell_Crochet Bag.png" alt="Seashell Crochet Bag">
            <div class="product-details">
                <h4>Seashell Crochet Bag</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱350</span>
                    <span class="category">              | Fashion</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

        <article class="grid-item" data-name="Strawberry Bucket Crochet Hat" data-price="200" data-img="Strawberry_Bucket Crochet Hat.png">
            <img class="product-image" src="Strawberry_Bucket Crochet Hat.webp" alt="Strawberry Bucket Crochet Hat">
            <div class="product-details">
                <h4>Strawberry Bucket Crochet Hat</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱200</span>
                    <span class="category">              | Fashion</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>

        <article class="grid-item" data-name="Sunflower Crochet Earrings" data-price="150" data-img="Sunflower_Crochet Earrings.png">
            <img class="product-image" src="Sunflower_Crochet Earrings.png" alt="Sunflower Crochet Earrings">
            <div class="product-details">
                <h4>Sunflower Crochet Earrings</h4>
                <h5>@TheCreativeShop</h5>
                <p class="price-line">
                    <span class="price">₱145</span>
                    <span class="category">              | Jewelry</span>            
                </p>
            </div>

            <div class="product-actions">
                <button class="btn btn-outline btn-view">View</button>
                <button class="btn btn-primary btn-add">Add to Cart</button>
            </div>
        </article>
    </section>
  
</main>

<aside class="cart-sidebar" id="cartSidebar" aria-hidden="true" aria-label="Shopping cart">
    <div class="cart-header">
        <div>
            <strong>Shopping Cart</strong><br>
            <span class="small">Items in your cart</span>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
            <button id="clearCartBtn" class="btn btn-outline" title="Clear cart">Clear</button>
            <button id="closeCartBtn" class="btn" aria-label="Close cart">✕</button>
        </div>
    </div>

    <div class="cart-body" id="cartItemsWrap">
        <p class="small">Your cart is empty — add something lovely ✨</p>
    </div>

    <div class="cart-footer">
        <div class="total-row">
            <span>Total</span>
            <span id="cartTotal">₱0.00</span>
        </div>
        <div style="display:flex;gap:8px;margin-top:10px">
            <button id="checkoutBtn" class="btn btn-primary" style="flex:1">Proceed to Payment</button>
            <button id="continueBtn" class="btn btn-outline" style="flex:1">Continue Shopping</button>
        </div>
    </div>
</aside>

<div id="productModal" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modalName">
        <button class="close-btn" id="modalCloseBtn" aria-label="Close">×</button>
        <img id="modalImage" src="" alt="">
        <h2 id="modalName"></h2>
        <h3 style="color:var(--color-accent)">₱ <span id="modalPrice"></span></h3>
        <p id="modalDesc">Handmade with care. Click Add to Cart to include this item in your cart.</p>

        <div style="display:flex;gap:12px;align-items:center;margin-top:12px">
            <div class="qty-controls">
                <button class="qty-btn" id="qtyDec">−</button>
                <input id="modalQty" type="number" min="1" value="1" style="width:68px;padding:6px;border-radius:6px;border:1px solid #ddd;text-align:center">
                <button class="qty-btn" id="qtyInc">+</button>
            </div>

            <div style="margin-left:auto">
                <button id="modalAddBtn" class="btn btn-primary">Add to Cart</button>
            </div>
        </div>
    </div>
</div>

<div id="paymentModal" class="modal" aria-hidden="true">
    <div class="modal-content">
        <button class="close-btn" id="paymentCloseBtn" aria-label="Close">×</button>
        <h2>Payment Summary</h2>
        <table id="paymentTable">
            <thead>
                <tr><th>Item</th><th>Qty</th><th>Price</th><th>Subtotal</th></tr>
            </thead>
            <tbody></tbody>
        </table>
        <h3 style="text-align:right;margin-top:12px">Total: ₱<span id="paymentTotal">0.00</span></h3>
    </div>
</div>

<footer>
    <small>© NYAFTISANS — Human Creativity at its Finest</small>
</footer>

<script>

// GEOLOCATION
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition( // popups permission
            function(position) {
                alert("You accepted the request to retrieve your location.");
            },
          function(error) {
            alert("You denied access to retrieve your location.");
          }
        );
      } else {
        alert("Geolocation is not supported by this browser.");
    }

document.addEventListener('DOMContentLoaded', () => {
    // --- Global Element Selectors (UI) ---
    const profileIcon = document.getElementById('profileIcon');
    const profileDropdown = document.getElementById('profileDropdown');
    const cartLink = document.getElementById('cartLink');
    const cartIcon = document.getElementById('cartIcon');
    const shoppingCartSidebar = document.getElementById('shoppingCartSidebar');
    const cartBackdrop = document.getElementById('cartBackdrop');
    const closeCartBtn = document.getElementById('closeCartBtn');
    const continueShoppingBtn = document.getElementById('continueShoppingBtn');
    const cartItemsList = document.getElementById('cartItemsList');
    const emptyCartMessage = document.getElementById('emptyCartMessage');
    const cartTotalDisplay = document.getElementById('cartTotal');
    const cartItemCountDisplay = document.getElementById('cartItemCount');
    const clearCartBtn = document.getElementById('clearCartBtn');
    
    // --- Modal Element Selectors (Product Modal) ---
    const productModal = document.getElementById('productModal');
    const modalImage = document.getElementById('modal-product-image');
    const modalProductName = document.getElementById('modal-product-name');
    const modalProductPrice = document.getElementById('modal-product-price');
    const modalProductDescription = document.getElementById('modal-product-description');
    const modalVariations = document.getElementById('modal-variation-options');
    const modalStockInfo = document.getElementById('modal-stock-info');
    const modalQuantityInput = document.getElementById('modal-qty');
    const modalCloseButton = productModal ? productModal.querySelector('.close-button') : null;

    // --- Product Grid Button Selectors ---
    const gridAddToCartButtons = document.querySelectorAll('.add-to-cart-grid-btn');
    const viewButtons = document.querySelectorAll('.buy-now-grid-btn');
    
    let cartItems = [];

    // --- Core Cart Logic Functions (updateCartUI, openCart, closeCart) ---
    function updateCartUI() {
        let total = 0;
        let count = 0;
        cartItemsList.innerHTML = '';

        if (cartItems.length === 0) {
            emptyCartMessage.style.display = 'block';
            clearCartBtn.disabled = true;
        } else {
            emptyCartMessage.style.display = 'none';
            clearCartBtn.disabled = false;
        }

        cartItems.forEach(item => {
            const priceNum = parseFloat(item.price.replace('₱', '').trim()) || 0;
            const subtotal = priceNum * item.quantity;
            total += subtotal;
            count += item.quantity;

            const itemRow = document.createElement('div');
            itemRow.className = 'cart-item';
            
            // Item Name (can be updated to include variation if needed later)
            const name = document.createElement('div');
            name.textContent = item.name + (item.selectedVariation ? ` - ${item.selectedVariation}` : ''); 
            name.style.flex = '1';
            name.style.fontSize = '15px';

            // Quantity Input
            const qty = document.createElement('input');
            qty.type = 'number';
            qty.min = '1';
            qty.value = item.quantity;
            qty.style.width = '60px';
            qty.addEventListener('change', (e) => {
                const val = parseInt(e.target.value);
                if (isNaN(val) || val < 1) { e.target.value = item.quantity; return; }
                item.quantity = val;
                updateCartUI();
            });

            // Price Display
            const priceEl = document.createElement('div');
            priceEl.style.minWidth = '80px';
            priceEl.style.textAlign = 'right';
            priceEl.style.fontWeight = '700';
            priceEl.textContent = '₱ ' + subtotal.toFixed(2);

            itemRow.appendChild(name);
            itemRow.appendChild(qty);
            itemRow.appendChild(priceEl);

            cartItemsList.appendChild(itemRow);
        });

        cartTotalDisplay.textContent = '₱ ' + total.toFixed(2);
        cartItemCountDisplay.textContent = count + ' Item' + (count === 1 ? '' : 's') + ' in your cart';
    }

    function openCart() {
        shoppingCartSidebar.classList.add('open');
        cartBackdrop.classList.add('open');
        document.body.style.overflow = 'hidden';
        if (profileDropdown.classList.contains('visible')) {
            profileDropdown.classList.remove('visible');
            profileIcon.classList.remove('active');
            profileIcon.setAttribute('aria-expanded', 'false');
        }
        updateCartUI();
        cartLink.setAttribute('aria-expanded', 'true');
        shoppingCartSidebar.setAttribute('aria-hidden', 'false');
        cartBackdrop.setAttribute('aria-hidden', 'false');
    }
    
    function closeCart() {
        shoppingCartSidebar.classList.remove('open');
        cartBackdrop.classList.remove('open');
        document.body.style.overflow = '';
        cartLink.setAttribute('aria-expanded', 'false');
        shoppingCartSidebar.setAttribute('aria-hidden', 'true');
        cartBackdrop.setAttribute('aria-hidden', 'true');
    }

    // Function to add item (with optional quantity/variation)
    function addItemToCart(itemDetails) {
        const uniqueId = itemDetails.id + (itemDetails.selectedVariation ? `-${itemDetails.selectedVariation.replace(/\s/g, '')}` : '');
        
        const found = cartItems.find(i => i.uniqueId === uniqueId);
        
        if (found) {
            found.quantity += itemDetails.quantity;
        } else {
            cartItems.push({ 
                uniqueId: uniqueId, 
                id: itemDetails.id,
                name: itemDetails.name, 
                price: itemDetails.price, 
                quantity: itemDetails.quantity,
                selectedVariation: itemDetails.selectedVariation // Store the selected variation
            });
        }
        
        // Visual feedback
        cartIcon.classList.remove('pulse');
        void cartIcon.offsetWidth; 
        cartIcon.classList.add('pulse');
        updateCartUI();
    }
    // --- End Core Cart Logic Functions ---


    // --- 1. PRODUCT GRID 'ADD TO CART' BUTTONS (Quick Add to Sidebar) ---
    gridAddToCartButtons.forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const card = btn.closest('.grid-item');
            if (!card) return;
            
            const name = card.querySelector('.product-details h4') ? card.querySelector('.product-details h4').textContent.trim() : 'Item';
            const priceEl = card.querySelector('.price') ? card.querySelector('.price').textContent.trim() : '₱ 0.00';
            const productID = btn.previousElementSibling.dataset.id; // Get ID from the View button

            // Quick add assumes Quantity: 1 and No Variation
            addItemToCart({ 
                id: productID,
                name: name, 
                price: priceEl, 
                quantity: 1, 
                selectedVariation: null 
            });

            // Visual feedback: button text change
            const orig = btn.textContent;
            btn.textContent = 'Added!';
            btn.disabled = true;
            setTimeout(() => { btn.textContent = orig; btn.disabled = false; }, 900);
        });
    });


    // --- 2. PRODUCT GRID 'VIEW' BUTTONS (Open Modal) ---
    viewButtons.forEach(button => {
        button.addEventListener('click', (event) => {
            if (!productModal) return; 
            const productData = event.target.dataset;

            // Store current product data in the modal for access by 'Add to Cart' inside the modal
            productModal.dataset.currentId = productData.id;
            productModal.dataset.currentName = productData.name;
            productModal.dataset.currentPrice = productData.price;

            // Populate modal with product data
            modalImage.src = productData.image;
            modalImage.alt = productData.name;
            modalProductName.textContent = productData.name;
            modalProductPrice.textContent = `₱ ${parseFloat(productData.price).toFixed(2)}`;
            modalProductDescription.textContent = productData.description;

            // Handle variations (clear and populate)
            modalVariations.innerHTML = '';
            const variationsRaw = productData.variations ? productData.variations.split(',') : [];
            
            if (variationsRaw.length > 0 && variationsRaw.every(v => v.trim() !== '')) { 
                productModal.dataset.requiresVariation = 'true'; // Flag for validation
                
                variationsRaw.forEach((variation, index) => {
                    const cleanVariation = variation.trim();
                    const variationButton = document.createElement('button');
                    variationButton.classList.add('variation-option');
                    variationButton.textContent = cleanVariation;
                    
                    // Automatically select the first option
                    if (index === 0) {
                        variationButton.classList.add('selected');
                        productModal.dataset.selectedVariation = cleanVariation; 
                    }
                    
                    // Variation selection logic
                    variationButton.addEventListener('click', function() {
                        modalVariations.querySelectorAll('.variation-option').forEach(btn => {
                            btn.classList.remove('selected');
                        });
                        this.classList.add('selected');
                        productModal.dataset.selectedVariation = cleanVariation; // Store selection
                    });
                    modalVariations.appendChild(variationButton);
                });
            } else {
                modalVariations.textContent = 'No variations required.';
                productModal.dataset.requiresVariation = 'false';
                productModal.dataset.selectedVariation = ''; // Clear selection
            }

            // Handle quantity and stock
            const productStock = parseInt(productData.stock, 10) || 0;
            modalQuantityInput.value = 1;
            modalQuantityInput.min = 1;
            modalQuantityInput.max = productStock;
            modalStockInfo.textContent = `(${productStock} items available)`;

            // Show the modal
            productModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
    });

    
    // --- 3. MODAL 'ADD TO CART' BUTTON LOGIC (Pulls data from modal's dataset) ---
    const modalAddToCartBtn = document.getElementById('modal-add-to-cart'); 
    
    // NOTE: You need to ensure your modal HTML has an element with id="modal-add-to-cart"
    if (modalAddToCartBtn) {
        modalAddToCartBtn.addEventListener('click', () => {
            const qty = parseInt(modalQuantityInput.value, 10);
            const stock = parseInt(modalQuantityInput.max, 10);
            const requiresVariation = productModal.dataset.requiresVariation === 'true';
            const selectedVariation = productModal.dataset.selectedVariation;

            // Validation Checks
            if (qty < 1 || isNaN(qty) || qty > stock) {
                alert(`Please enter a valid quantity between 1 and ${stock}.`);
                return;
            }
            if (requiresVariation && !selectedVariation) {
                alert('Please select a variation before adding to cart.');
                return;
            }

            const itemDetails = {
                id: productModal.dataset.currentId,
                name: productModal.dataset.currentName,
                price: `₱ ${productModal.dataset.currentPrice}`,
                quantity: qty,
                selectedVariation: selectedVariation || null
            };

            addItemToCart(itemDetails);
            productModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            openCart(); // Optionally open the cart sidebar after adding an item
        });
    }


    // --- 4. MODAL CLOSING LOGIC ---
    if (modalCloseButton) {
        modalCloseButton.addEventListener('click', () => {
            productModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        });
        window.addEventListener('click', (event) => {
            if (event.target === productModal) {
                productModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        });
    }

    // --- Existing UI Event Listeners (Profile, Cart Toggles, Clear Cart, etc.) ---
    // (Existing UI toggle and scroll logic preserved here for completeness)
    // profile toggle
    profileIcon.addEventListener('click', (e) => {
        e.stopPropagation();
        const visible = profileDropdown.classList.toggle('visible');
        profileIcon.classList.toggle('active', visible);
        profileIcon.setAttribute('aria-expanded', visible ? 'true' : 'false');
        profileDropdown.setAttribute('aria-hidden', visible ? 'false' : 'true');

        if (visible && shoppingCartSidebar.classList.contains('open')) closeCart();
    });
    // allow keyboard open
    profileIcon.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); profileIcon.click(); }
    });

    // close dropdown/backdrop when clicking outside
    document.addEventListener('click', (e) => {
        if (profileDropdown.classList.contains('visible') && !profileIcon.contains(e.target) && !profileDropdown.contains(e.target)) {
            profileDropdown.classList.remove('visible');
            profileIcon.classList.remove('active');
            profileIcon.setAttribute('aria-expanded', 'false');
            profileDropdown.setAttribute('aria-hidden', 'true');
        }
        if (cartBackdrop.classList.contains('open') && e.target === cartBackdrop) closeCart();
    });

    // cart toggle
    cartLink.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        if (shoppingCartSidebar.classList.contains('open')) closeCart();
        else openCart();
    });
    closeCartBtn.addEventListener('click', closeCart);
    continueShoppingBtn.addEventListener('click', (e) => { e.preventDefault(); closeCart(); });

    // clear cart with confirmation
    clearCartBtn.addEventListener('click', () => {
        if (confirm('Are you sure you want to clear your entire cart?')) {
            cartItems = [];
            updateCartUI();
        }
    });

    // drag-to-scroll for scrollable-content
    const scrollSection = document.getElementById('scroll-section');
    if (scrollSection) {
        let isDown = false, startX, scrollLeft;
        const start = (e) => { isDown = true; scrollSection.style.cursor = 'grabbing'; startX = (e.pageX || e.touches?.[0]?.pageX); scrollLeft = scrollSection.scrollLeft; }
        const stop = () => { isDown = false; scrollSection.style.cursor = 'grab'; }
        const move = (e) => { if (!isDown) return; e.preventDefault(); const x = (e.pageX || e.touches?.[0]?.pageX); const dist = (x - startX); scrollSection.scrollLeft = scrollLeft - dist; }
        scrollSection.addEventListener('mousedown', start); scrollSection.addEventListener('mouseup', stop); scrollSection.addEventListener('mouseleave', stop); scrollSection.addEventListener('mousemove', move);
        scrollSection.addEventListener('touchstart', start); scrollSection.addEventListener('touchend', stop); scrollSection.addEventListener('touchmove', move);
    }

    // init UI
    updateCartUI();
});

    (function(){
        // App state
        const cart = []; // {name, price, qty, img}
        const selectors = {
            cartButton: document.getElementById('cartButton'),
            cartSidebar: document.getElementById('cartSidebar'),
            cartItemsWrap: document.getElementById('cartItemsWrap'),
            cartTotal: document.getElementById('cartTotal'),
            cartBadge: document.getElementById('cartBadge'),
            closeCartBtn: document.getElementById('closeCartBtn'),
            clearCartBtn: document.getElementById('clearCartBtn'),
            continueBtn: document.getElementById('continueBtn'),
            checkoutBtn: document.getElementById('checkoutBtn'),
            productGrid: document.getElementById('productGrid'),
            productModal: document.getElementById('productModal'),
            modalCloseBtn: document.getElementById('modalCloseBtn'),
            modalImage: document.getElementById('modalImage'),
            modalName: document.getElementById('modalName'),
            modalPrice: document.getElementById('modalPrice'),
            modalDesc: document.getElementById('modalDesc'),
            modalQty: document.getElementById('modalQty'),
            qtyDec: document.getElementById('qtyDec'),
            qtyInc: document.getElementById('qtyInc'),
            modalAddBtn: document.getElementById('modalAddBtn'),
            paymentModal: document.getElementById('paymentModal'),
            paymentCloseBtn: document.getElementById('paymentCloseBtn'),
            paymentTableBody: document.querySelector('#paymentTable tbody'),
            paymentTotal: document.getElementById('paymentTotal'),
            
            // PROFILE SELECTORS
            profileIcon: document.getElementById('profileIcon'),
            profileMenu: document.getElementById('profileMenu'),
            editProfileLink: document.getElementById('editProfileLink'),
            aboutLink: document.getElementById('aboutLink'),
            signOutLink: document.getElementById('signOutLink'),
        };

        // Helpers
        function formatPHP(n){ return '₱' + n.toFixed(2); }

        function updateCartBadge(){
            const totalItems = cart.reduce((s,i)=>s+i.qty,0);
            if(totalItems > 0){
                selectors.cartBadge.style.display = 'block';
                selectors.cartBadge.textContent = totalItems;
            } else {
                selectors.cartBadge.style.display = 'none';
            }
        }

        function calcTotal(){
            return cart.reduce((s,i)=>s + i.price * i.qty, 0);
        }

        function renderCart(){
            const wrap = selectors.cartItemsWrap;
            wrap.innerHTML = '';
            if(cart.length === 0){
                wrap.innerHTML = '<p class="small">Your cart is empty — add something lovely ✨</p>';
            } else {
                cart.forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'cart-item-row';
                    div.innerHTML = `
                        <img src="${item.img}" alt="${escapeHtml(item.name)}">
                        <div class="cart-item-info">
                            <h4>${escapeHtml(item.name)}</h4>
                            <div class="item-meta">
                                <span class="small">${formatPHP(item.price)}</span>
                                <div style="display:flex;align-items:center;gap:8px">
                                    <input type="number" class="qty-input" value="${item.qty}" min="1" data-index="${index}">
                                    <button class="remove-btn" data-index="${index}">Remove</button>
                                </div>
                            </div>
                        </div>
                    `;
                    wrap.appendChild(div);
                });
            }
            selectors.cartTotal.textContent = formatPHP(calcTotal());
            updateCartBadge();
        }

        // Escape helper
        function escapeHtml(text){
            return text.replace(/[&<>"']/g, function(m){ return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])});
        }

        // Add to cart logic
        function addItemToCart(obj){
            // obj: {name, price, qty=1, img}
            const existing = cart.find(i => i.name === obj.name);
            if(existing){
                existing.qty += obj.qty;
            } else {
                cart.push({...obj});
            }
            renderCart();
            openCart();
        }

        // Remove item
        function removeItem(index){
            if(index >= 0 && index < cart.length){
                cart.splice(index,1);
                renderCart();
            }
        }

        // Update qty
        function updateQty(index, qty){
            qty = parseInt(qty);
            if(isNaN(qty) || qty < 1) qty = 1;
            if(cart[index]) {
                cart[index].qty = qty;
                renderCart();
            }
        }

        // Open/close cart
        function openCart(){ selectors.cartSidebar.classList.add('open'); selectors.cartSidebar.setAttribute('aria-hidden','false'); }
        function closeCart(){ selectors.cartSidebar.classList.remove('open'); selectors.cartSidebar.setAttribute('aria-hidden','true'); }
        
        // Open/close profile menu
        function toggleProfileMenu(){
            selectors.profileMenu.classList.toggle('open');
            const isOpen = selectors.profileMenu.classList.contains('open');
            selectors.profileMenu.setAttribute('aria-hidden', !isOpen);
        }
        function closeProfileMenu(){
            selectors.profileMenu.classList.remove('open');
            selectors.profileMenu.setAttribute('aria-hidden', 'true');
        }

        // EVENT: Cart button click (open)
        selectors.cartButton.addEventListener('click', ()=> {
            closeProfileMenu(); // Close profile menu if open
            openCart();
        });
        selectors.closeCartBtn.addEventListener('click', ()=> closeCart());
        selectors.continueBtn.addEventListener('click', ()=> closeCart());
        selectors.clearCartBtn.addEventListener('click', ()=> {
            cart.length = 0;
            renderCart();
        });

        // EVENT: Profile Icon click (toggle)
        selectors.profileIcon.addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent the window click listener from immediately closing it
            closeCart(); // Close cart if open
            toggleProfileMenu();
        });
        
        // EVENT: Profile Menu links
        selectors.signOutLink.addEventListener('click', (e) => {
            e.preventDefault(); 
            alert('Signing you out. Goodbye!');
            closeProfileMenu();
            // In a real application, you would handle the actual sign-out logic here.
        });


        // Event delegation for cart items (qty change / remove)
        selectors.cartItemsWrap.addEventListener('input', (e)=>{
            if(e.target.matches('.qty-input')){
                const idx = parseInt(e.target.dataset.index);
                updateQty(idx, e.target.value);
            }
        });

        selectors.cartItemsWrap.addEventListener('change', (e)=>{
            if(e.target.matches('.qty-input')){
                const idx = parseInt(e.target.dataset.index);
                updateQty(idx, e.target.value);
            }
        });

        selectors.cartItemsWrap.addEventListener('click', (e)=>{
            if(e.target.matches('.remove-btn')){
                const idx = parseInt(e.target.dataset.index);
                removeItem(idx);
            }
        });

        // PRODUCT GRID: View and Add buttons
        selectors.productGrid.addEventListener('click', (e)=>{
            const item = e.target.closest('.grid-item');
            if(!item) return;

            const name = item.dataset.name;
            const price = parseFloat(item.dataset.price);
            const img = item.dataset.img;

            if(e.target.matches('.btn-view')){
                openProductModal({name, price, img});
            } else if(e.target.matches('.btn-add')){
                addItemToCart({name, price, qty:1, img});
            } else {
                // clicking elsewhere on card opens view
                if(!e.target.classList.contains('btn') && !e.target.closest('button')){
                    openProductModal({name, price, img});
                }
            }
        });

        // PRODUCT MODAL operations
        function openProductModal({name, price, img}){
            selectors.modalImage.src = img;
            selectors.modalName.textContent = name;
            selectors.modalPrice.textContent = price.toFixed(2);
            selectors.modalDesc.textContent = 'Handmade with care. Click Add to Cart to include this item in your cart.';
            selectors.modalQty.value = 1;
            selectors.productModal.classList.add('visible');
            selectors.productModal.setAttribute('aria-hidden','false');
        }
        function closeProductModal(){
            selectors.productModal.classList.remove('visible');
            selectors.productModal.setAttribute('aria-hidden','true');
        }
        selectors.modalCloseBtn.addEventListener('click', closeProductModal);
        document.getElementById('modalAddBtn').addEventListener('click', ()=>{
            const name = selectors.modalName.textContent;
            const price = parseFloat(selectors.modalPrice.textContent);
            const img = selectors.modalImage.src;
            const qty = parseInt(selectors.modalQty.value) || 1;
            addItemToCart({name, price, qty, img});
            closeProductModal();
        });
        selectors.qtyDec.addEventListener('click', ()=> { let v = parseInt(selectors.modalQty.value)||1; if(v>1) selectors.modalQty.value = v-1; });
        selectors.qtyInc.addEventListener('click', ()=> { let v = parseInt(selectors.modalQty.value)||1; selectors.modalQty.value = v+1; });

        // Close modals/menus when clicking outside
        window.addEventListener('click', (e)=>{
            if(e.target === selectors.productModal) closeProductModal();
            if(e.target === selectors.paymentModal) closePaymentModal();
            
            // Close profile menu if clicked outside
            if (selectors.profileMenu.classList.contains('open') && !selectors.profileIcon.contains(e.target) && !selectors.profileMenu.contains(e.target)) {
                closeProfileMenu();
            }
        });

        // Checkout / Payment modal
        selectors.checkoutBtn.addEventListener('click', openPaymentModal);
        selectors.paymentCloseBtn.addEventListener('click', closePaymentModal);

        function openPaymentModal(){
            // populate payment table
            selectors.paymentTableBody.innerHTML = '';
            let total = 0;
            if(cart.length === 0){
                selectors.paymentTableBody.innerHTML = '<tr><td colspan="4">No items in cart.</td></tr>';
            } else {
                cart.forEach(item=>{
                    const subtotal = item.price * item.qty;
                    total += subtotal;
                    const tr = document.createElement('tr');
                    // Corrected: Using template literal syntax
                    tr.innerHTML = `<td>${escapeHtml(item.name)}</td><td>${item.qty}</td><td>₱${item.price.toFixed(2)}</td><td>₱${subtotal.toFixed(2)}</td>`;
                    selectors.paymentTableBody.appendChild(tr);
                });
            }
            selectors.paymentTotal.textContent = total.toFixed(2);
            selectors.paymentModal.classList.add('visible');
            selectors.paymentModal.setAttribute('aria-hidden','false');
        }

        function closePaymentModal(){
            selectors.paymentModal.classList.remove('visible');
            selectors.paymentModal.setAttribute('aria-hidden','true');
        }

        // Small search (client-side filter)
        document.getElementById('searchBtn').addEventListener('click', ()=>{
            const q = document.getElementById('searchInput').value.trim().toLowerCase();
            filterProducts(q);
        });
        document.getElementById('searchInput').addEventListener('keydown', (e)=>{
            if(e.key === 'Enter') { e.preventDefault(); document.getElementById('searchBtn').click(); }
        });

        function filterProducts(q){
            const items = document.querySelectorAll('.grid-item');
            items.forEach(it=>{
                const name = it.dataset.name.toLowerCase();
                if(!q || name.includes(q)) it.style.display = '';
                else it.style.display = 'none';
            });
        }

        // small helper to initial render
        renderCart();
    })();

    document.addEventListener('DOMContentLoaded', () => {
    // --- Global Element Selectors (UI) ---
    const profileIcon = document.getElementById('profileIcon');
    const profileDropdown = document.getElementById('profileDropdown');
    const cartLink = document.getElementById('cartLink');
    const cartIcon = document.getElementById('cartIcon');
    const shoppingCartSidebar = document.getElementById('shoppingCartSidebar');
    const cartBackdrop = document.getElementById('cartBackdrop');
    const closeCartBtn = document.getElementById('closeCartBtn');
    const continueShoppingBtn = document.getElementById('continueShoppingBtn');
    const cartItemsList = document.getElementById('cartItemsList');
    const emptyCartMessage = document.getElementById('emptyCartMessage');
    const cartTotalDisplay = document.getElementById('cartTotal');
    const cartItemCountDisplay = document.getElementById('cartItemCount');
    const clearCartBtn = document.getElementById('clearCartBtn');
    
    // --- Modal Element Selectors (Product Modal) ---
    const productModal = document.getElementById('productModal');
    const modalImage = document.getElementById('modal-product-image');
    const modalProductName = document.getElementById('modal-product-name');
    const modalProductPrice = document.getElementById('modal-product-price');
    const modalProductDescription = document.getElementById('modal-product-description');
    const modalVariations = document.getElementById('modal-variation-options');
    const modalStockInfo = document.getElementById('modal-stock-info');
    const modalQuantityInput = document.getElementById('modal-qty');
    const modalCloseButton = productModal ? productModal.querySelector('.close-button') : null;

    // --- Product Grid Button Selectors ---
    const gridAddToCartButtons = document.querySelectorAll('.add-to-cart-grid-btn');
    const viewButtons = document.querySelectorAll('.buy-now-grid-btn');
    
    let cartItems = [];

    

    // --- Core Cart Logic Functions (updateCartUI, openCart, closeCart) ---
    function updateCartUI() {
        let total = 0;
        let count = 0;
        cartItemsList.innerHTML = '';

        if (cartItems.length === 0) {
            emptyCartMessage.style.display = 'block';
            clearCartBtn.disabled = true;
        } else {
            emptyCartMessage.style.display = 'none';
            clearCartBtn.disabled = false;
        }

        cartItems.forEach(item => {
            const priceNum = parseFloat(item.price.replace('₱', '').trim()) || 0;
            const subtotal = priceNum * item.quantity;
            total += subtotal;
            count += item.quantity;

            const itemRow = document.createElement('div');
            itemRow.className = 'cart-item';
            
            // Item Name (can be updated to include variation if needed later)
            const name = document.createElement('div');
            name.textContent = item.name + (item.selectedVariation ? ` - ${item.selectedVariation}` : ''); 
            name.style.flex = '1';
            name.style.fontSize = '15px';

            // Quantity Input
            const qty = document.createElement('input');
            qty.type = 'number';
            qty.min = '1';
            qty.value = item.quantity;
            qty.style.width = '60px';
            qty.addEventListener('change', (e) => {
                const val = parseInt(e.target.value);
                if (isNaN(val) || val < 1) { e.target.value = item.quantity; return; }
                item.quantity = val;
                updateCartUI();
            });

            // Price Display
            const priceEl = document.createElement('div');
            priceEl.style.minWidth = '80px';
            priceEl.style.textAlign = 'right';
            priceEl.style.fontWeight = '700';
            priceEl.textContent = '₱ ' + subtotal.toFixed(2);

            itemRow.appendChild(name);
            itemRow.appendChild(qty);
            itemRow.appendChild(priceEl);

            cartItemsList.appendChild(itemRow);
        });

        cartTotalDisplay.textContent = '₱ ' + total.toFixed(2);
        cartItemCountDisplay.textContent = count + ' Item' + (count === 1 ? '' : 's') + ' in your cart';
    }

    function openCart() {
        shoppingCartSidebar.classList.add('open');
        cartBackdrop.classList.add('open');
        document.body.style.overflow = 'hidden';
        if (profileDropdown.classList.contains('visible')) {
            profileDropdown.classList.remove('visible');
            profileIcon.classList.remove('active');
            profileIcon.setAttribute('aria-expanded', 'false');
        }
        updateCartUI();
        cartLink.setAttribute('aria-expanded', 'true');
        shoppingCartSidebar.setAttribute('aria-hidden', 'false');
        cartBackdrop.setAttribute('aria-hidden', 'false');
    }
    
    function closeCart() {
        shoppingCartSidebar.classList.remove('open');
        cartBackdrop.classList.remove('open');
        document.body.style.overflow = '';
        cartLink.setAttribute('aria-expanded', 'false');
        shoppingCartSidebar.setAttribute('aria-hidden', 'true');
        cartBackdrop.setAttribute('aria-hidden', 'true');
    }

    // Function to add item (with optional quantity/variation)
    function addItemToCart(itemDetails) {
        const uniqueId = itemDetails.id + (itemDetails.selectedVariation ? `-${itemDetails.selectedVariation.replace(/\s/g, '')}` : '');
        
        const found = cartItems.find(i => i.uniqueId === uniqueId);
        
        if (found) {
            found.quantity += itemDetails.quantity;
        } else {
            cartItems.push({ 
                uniqueId: uniqueId, 
                id: itemDetails.id,
                name: itemDetails.name, 
                price: itemDetails.price, 
                quantity: itemDetails.quantity,
                selectedVariation: itemDetails.selectedVariation // Store the selected variation
            });
        }
        
        // Visual feedback
        cartIcon.classList.remove('pulse');
        void cartIcon.offsetWidth; 
        cartIcon.classList.add('pulse');
        updateCartUI();
    }
    // --- End Core Cart Logic Functions ---


    // --- 1. PRODUCT GRID 'ADD TO CART' BUTTONS (Quick Add to Sidebar) ---
    gridAddToCartButtons.forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const card = btn.closest('.grid-item');
            if (!card) return;
            
            const name = card.querySelector('.product-details h4') ? card.querySelector('.product-details h4').textContent.trim() : 'Item';
            const priceEl = card.querySelector('.price') ? card.querySelector('.price').textContent.trim() : '₱ 0.00';
            const productID = btn.previousElementSibling.dataset.id; // Get ID from the View button

            // Quick add assumes Quantity: 1 and No Variation
            addItemToCart({ 
                id: productID,
                name: name, 
                price: priceEl, 
                quantity: 1, 
                selectedVariation: null 
            });

            // Visual feedback: button text change
            const orig = btn.textContent;
            btn.textContent = 'Added!';
            btn.disabled = true;
            setTimeout(() => { btn.textContent = orig; btn.disabled = false; }, 900);
        });
    });


    // --- 2. PRODUCT GRID 'VIEW' BUTTONS (Open Modal) ---
    viewButtons.forEach(button => {
        button.addEventListener('click', (event) => {
            if (!productModal) return; 
            const productData = event.target.dataset;

            // Store current product data in the modal for access by 'Add to Cart' inside the modal
            productModal.dataset.currentId = productData.id;
            productModal.dataset.currentName = productData.name;
            productModal.dataset.currentPrice = productData.price;

            // Populate modal with product data
            modalImage.src = productData.image;
            modalImage.alt = productData.name;
            modalProductName.textContent = productData.name;
            modalProductPrice.textContent = `₱ ${parseFloat(productData.price).toFixed(2)}`;
            modalProductDescription.textContent = productData.description;

            // Handle variations (clear and populate)
            modalVariations.innerHTML = '';
            const variationsRaw = productData.variations ? productData.variations.split(',') : [];
            
            if (variationsRaw.length > 0 && variationsRaw.every(v => v.trim() !== '')) { 
                productModal.dataset.requiresVariation = 'true'; // Flag for validation
                
                variationsRaw.forEach((variation, index) => {
                    const cleanVariation = variation.trim();
                    const variationButton = document.createElement('button');
                    variationButton.classList.add('variation-option');
                    variationButton.textContent = cleanVariation;
                    
                    // Automatically select the first option
                    if (index === 0) {
                        variationButton.classList.add('selected');
                        productModal.dataset.selectedVariation = cleanVariation; 
                    }
                    
                    // Variation selection logic
                    variationButton.addEventListener('click', function() {
                        modalVariations.querySelectorAll('.variation-option').forEach(btn => {
                            btn.classList.remove('selected');
                        });
                        this.classList.add('selected');
                        productModal.dataset.selectedVariation = cleanVariation; // Store selection
                    });
                    modalVariations.appendChild(variationButton);
                });
            } else {
                modalVariations.textContent = 'No variations required.';
                productModal.dataset.requiresVariation = 'false';
                productModal.dataset.selectedVariation = ''; // Clear selection
            }

            // Handle quantity and stock
            const productStock = parseInt(productData.stock, 10) || 0;
            modalQuantityInput.value = 1;
            modalQuantityInput.min = 1;
            modalQuantityInput.max = productStock;
            modalStockInfo.textContent = `(${productStock} items available)`;

            // Show the modal
            productModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
    });

    
    // --- 3. MODAL 'ADD TO CART' BUTTON LOGIC (Pulls data from modal's dataset) ---
    const modalAddToCartBtn = document.getElementById('modal-add-to-cart'); 
    
    // NOTE: You need to ensure your modal HTML has an element with id="modal-add-to-cart"
    if (modalAddToCartBtn) {
        modalAddToCartBtn.addEventListener('click', () => {
            const qty = parseInt(modalQuantityInput.value, 10);
            const stock = parseInt(modalQuantityInput.max, 10);
            const requiresVariation = productModal.dataset.requiresVariation === 'true';
            const selectedVariation = productModal.dataset.selectedVariation;

            // Validation Checks
            if (qty < 1 || isNaN(qty) || qty > stock) {
                alert(`Please enter a valid quantity between 1 and ${stock}.`);
                return;
            }
            if (requiresVariation && !selectedVariation) {
                alert('Please select a variation before adding to cart.');
                return;
            }

            const itemDetails = {
                id: productModal.dataset.currentId,
                name: productModal.dataset.currentName,
                price: `₱ ${productModal.dataset.currentPrice}`,
                quantity: qty,
                selectedVariation: selectedVariation || null
            };

            addItemToCart(itemDetails);
            productModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            openCart(); // Optionally open the cart sidebar after adding an item
        });
    }

    


    // --- 4. MODAL CLOSING LOGIC ---
    if (modalCloseButton) {
        modalCloseButton.addEventListener('click', () => {
            productModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        });
        window.addEventListener('click', (event) => {
            if (event.target === productModal) {
                productModal.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
  const viewButtons = document.querySelectorAll('.btn-view');
  const modal = document.getElementById('productModal');
  const closeModalBtn = document.getElementById('closeModal');
  const modalCloseBottom = document.getElementById('modalCloseBottom');
  const modalImg = document.getElementById('modalImg');
  const modalName = document.getElementById('modalName');
  const modalPrice = document.getElementById('modalPrice');
  const modalSeller = document.getElementById('modalSeller');
  const modalDescription = document.getElementById('modalDescription');
  const modalAdd = document.getElementById('modalAdd');

  if (!modal || !closeModalBtn) {
    console.error("Modal or close button not found. Check your HTML IDs.");
    return;
  }

  document.addEventListener('DOMContentLoaded', () => {
  const modal = document.getElementById('productModal');
  const modalImg = document.getElementById('modalImg');
  const modalName = document.getElementById('modalName');
  const modalPrice = document.getElementById('modalPrice');
  const modalAddToCart = document.getElementById('modalAddToCart');
  const closeBtn = document.querySelector('.close-btn');
  let currentProduct = null;

  // Handle "View" button click
  document.querySelectorAll('.btn-view').forEach(button => {
    button.addEventListener('click', e => {
      const item = e.target.closest('.grid-item');
      const name = item.dataset.name;
      const price = item.dataset.price;
      const img = item.dataset.img;

      // Fill modal with product data
      modalName.textContent = name;
      modalPrice.textContent = `₱${price}`;
      modalImg.src = img;
      currentProduct = { name, price, img };

      // Show modal
      modal.style.display = 'flex';
    });
  });

  // Close modal
  closeBtn.addEventListener('click', () => modal.style.display = 'none');
  window.addEventListener('click', e => {
    if (e.target === modal) modal.style.display = 'none';
  });

  // Example: Add to Cart handler (replace with your real cart logic)
  modalAddToCart.addEventListener('click', () => {
    alert(`${currentProduct.name} added to cart!`);
    modal.style.display = 'none';
  });
});

let lastFocused = null;

  function openModalForProduct(productEl) {
    if (!productEl) return;
    const name = productEl.dataset.name || productEl.querySelector('h4')?.textContent?.trim() || 'Product';
    const price = productEl.dataset.price || productEl.querySelector('.price')?.textContent?.trim() || '—';
    const imgSrc = productEl.dataset.img?.trim() || productEl.querySelector('img')?.src || '';
    const seller = productEl.dataset.seller || productEl.querySelector('h5')?.textContent?.trim() || '@TheCreativeShop';
    const description = productEl.dataset.description || 'No additional description available.';

    if (modalImg) { modalImg.src = imgSrc; modalImg.alt = name; }
    if (modalName) modalName.textContent = name;
    if (modalPrice) modalPrice.textContent = price.toString().startsWith('₱') ? price : `₱${price}`;
    if (modalSeller) modalSeller.textContent = seller;
    if (modalDescription) modalDescription.textContent = description;

    modal.setAttribute('aria-hidden', 'false');
    lastFocused = document.activeElement;
    closeModalBtn.focus();
    document.body.style.overflow = 'hidden';
  }

  viewButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const product = btn.closest('.grid-item');
      openModalForProduct(product);
    });
  });

  function closeModal() {
    modal.setAttribute('aria-hidden', 'true');
    document.body.style.overflow = '';
    if (lastFocused?.focus) lastFocused.focus();
  }

  closeModalBtn.addEventListener('click', closeModal);
  modalCloseBottom?.addEventListener('click', closeModal);
  modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && modal.getAttribute('aria-hidden') === 'false') closeModal(); });

  modalAdd?.addEventListener('click', () => {
    console.log('Add to cart clicked for:', modalName?.textContent, modalPrice?.textContent);
    closeModal();
  });
});
   
    profileIcon.addEventListener('click', (e) => {
        e.stopPropagation();
        const visible = profileDropdown.classList.toggle('visible');
        profileIcon.classList.toggle('active', visible);
        profileIcon.setAttribute('aria-expanded', visible ? 'true' : 'false');
        profileDropdown.setAttribute('aria-hidden', visible ? 'false' : 'true');

        if (visible && shoppingCartSidebar.classList.contains('open')) closeCart();
    });
    // allow keyboard open
    profileIcon.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); profileIcon.click(); }
    });

    // close dropdown/backdrop when clicking outside
    document.addEventListener('click', (e) => {
        if (profileDropdown.classList.contains('visible') && !profileIcon.contains(e.target) && !profileDropdown.contains(e.target)) {
            profileDropdown.classList.remove('visible');
            profileIcon.classList.remove('active');
            profileIcon.setAttribute('aria-expanded', 'false');
            profileDropdown.setAttribute('aria-hidden', 'true');
        }
        if (cartBackdrop.classList.contains('open') && e.target === cartBackdrop) closeCart();
    });

    // cart toggle
    cartLink.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        if (shoppingCartSidebar.classList.contains('open')) closeCart();
        else openCart();
    });
    closeCartBtn.addEventListener('click', closeCart);
    continueShoppingBtn.addEventListener('click', (e) => { e.preventDefault(); closeCart(); });

    // clear cart with confirmation
    clearCartBtn.addEventListener('click', () => {
        if (confirm('Are you sure you want to clear your entire cart?')) {
            cartItems = [];
            updateCartUI();
        }
    });

    // drag-to-scroll for scrollable-content
    const scrollSection = document.getElementById('scroll-section');
    if (scrollSection) {
        let isDown = false, startX, scrollLeft;
        const start = (e) => { isDown = true; scrollSection.style.cursor = 'grabbing'; startX = (e.pageX || e.touches?.[0]?.pageX); scrollLeft = scrollSection.scrollLeft; }
        const stop = () => { isDown = false; scrollSection.style.cursor = 'grab'; }
        const move = (e) => { if (!isDown) return; e.preventDefault(); const x = (e.pageX || e.touches?.[0]?.pageX); const dist = (x - startX); scrollSection.scrollLeft = scrollLeft - dist; }
        scrollSection.addEventListener('mousedown', start); scrollSection.addEventListener('mouseup', stop); scrollSection.addEventListener('mouseleave', stop); scrollSection.addEventListener('mousemove', move);
        scrollSection.addEventListener('touchstart', start); scrollSection.addEventListener('touchend', stop); scrollSection.addEventListener('touchmove', move);
    }

    // init UI
    updateCartUI();
});
</script>

</body>
</html>